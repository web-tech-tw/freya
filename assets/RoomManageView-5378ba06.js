import{z as H,u as N,h as r,j as $,i as c,x as M,o,c as i,a as e,f as x,n as D,l as w,t as d,e as p,p as b,g as L,q as B,s as U}from"./index-a71a7996.js";import{u as Y,_ as k}from"./LoadingCircleIcon-72e2532f.js";import{_ as z}from"./ToastModal-7e3bd8cb.js";const F={key:0,class:"flex flex-wrap w-full justify-center bg-white py-20"},q={key:1,class:"flex flex-wrap w-full justify-center bg-white py-20"},K={class:"flex justify-center my-16"},P={class:"max-w-md py-4 px-8 bg-white shadow-lg rounded-lg my-20"},G={class:"flex justify-center md:justify-end -mt-16"},J=["alt","src"],Q={class:"text-gray-800 text-3xl font-semibold"},W={class:"text-sm font-normal"},X={class:"mt-6 text-gray-600"},Z={class:"text-gray-600"},ee={class:"mt-6 text-gray-600"},te=["innerHTML"],se={class:"w-full mb-4 text-gray-600 flex rounded bg-white shadow-md"},ae=["value"],oe={class:"flex justify-end mt-8"},le=["disabled"],ne={key:1},de={__name:"RoomManageView",setup(re){const{VITE_FREYA_INTE_HOST:E}={VITE_HOME_INTE_HOST:"https://web-tech.tw",VITE_SARA_INTE_HOST:"https://web-tech.tw/sara",VITE_SARA_RECV_HOST:"https://web-tech.tw/recv/sara",VITE_SARA_TOKEN_NAME:"unified_token",VITE_FREYA_INTE_HOST:"https://web-tech.tw/freya",VITE_FREYA_RECV_HOST:"https://web-tech.tw/recv/freya",VITE_TURNSTILE_SITE_KEY:"0x4AAAAAAAz8kwCfcwYC8fgp",BASE_URL:"/freya/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},T=H(),y=N(),g=Y(),{roomCode:l}=T.params,m=r(!1),v=r(!1),u=r(!1),f=r(!1),n=r(""),a=$({label:"",members:0,description:"",backgroundImage:"",administrators:[]}),I=c(()=>a.administrators.length),h=c(()=>`${E}/#/ti/g2/${l}`),A=c(()=>{const t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"},{description:s}=a;return s==null?void 0:s.replace(/[&<>"']/g,_=>t[_]).replaceAll(`
`,"<br />")}),C=c(()=>{const{backgroundImage:t}=a;return t?{backgroundImage:`url(${t})`}:{}}),V=c(()=>{const{backgroundImage:t}=a;return t?"backdrop-brightness-50":""}),R=async()=>{if(!navigator.clipboard){n.value="您的瀏覽器不支援複製功能";return}try{await navigator.clipboard.writeText(h.value),n.value="已複製邀請網址",f.value=!0,setTimeout(()=>{f.value=!1},3e3)}catch(t){n.value="無法複製邀請網址",console.error(t)}},S=async()=>{u.value=!0;const t=await g.patch(`rooms/${l}`).json();Object.assign(a,t),n.value="更新成功",u.value=!1},j=()=>{y.push(`/rooms/${l}/administrators`)},O=()=>{y.push(`/rooms/${l}/submissions`)};return M(async()=>{m.value=!0;try{const t=await g.get(`rooms/${l}`).json();Object.assign(a,t)}catch(t){v.value=!0,console.error(t)}m.value=!1}),(t,s)=>(o(),i("div",{style:L(C.value)},[v.value?(o(),i("div",F,s[1]||(s[1]=[e("div",{class:"text-center text-red-500"}," 發生錯誤 ",-1)]))):m.value?(o(),i("div",q,[e("div",K,[x(k,{class:"h-8 w-8 animate-spin text-lime-600"})])])):(o(),i("div",{key:2,class:D(["flex flex-wrap w-full justify-center py-20",V.value])},[e("div",P,[e("div",G,[e("img",{alt:a.label,src:a.backgroundImage,class:"w-20 h-20 object-cover rounded-full border-2 border-white-500"},null,8,J)]),e("div",null,[e("h2",Q,[w(d(a.label)+" ",1),e("span",W,d(p(l)),1)]),e("p",X," 管理員人數："+d(I.value),1),e("p",Z," 成員人數："+d(a.members),1),e("div",ee,[s[2]||(s[2]=w(" 簡介： ")),e("p",{class:"my-2 mx-1 text-gray-800 text-sm",innerHTML:A.value},null,8,te)]),s[3]||(s[3]=e("p",{class:"mt-4 text-gray-600"}," 社群邀請網址： ",-1)),e("div",se,[e("input",{value:h.value,class:"w-full border-none bg-transparent px-4 py-3 text-gray-900 outline-none focus:outline-none text-gray-500",type:"text",readonly:""},null,8,ae),e("button",{title:"複製",class:"m-2 rounded px-4 py-2 font-semibold",onClick:R},[f.value?(o(),b(p(B),{key:0,class:"h-6 w-6"})):(o(),b(p(U),{key:1,class:"h-6 w-6"}))])])]),e("div",oe,[e("button",{class:"flex items-center justify-center bg-blue-700 hover:bg-blue-800 text-white font-bold py-2 px-4 rounded-full mr-3",disabled:u.value,onClick:S},[u.value?(o(),b(k,{key:0,class:"h-6 w-6 animate-spin"})):(o(),i("span",ne," 更新資訊 "))],8,le),e("button",{class:"flex items-center justify-center bg-amber-700 hover:bg-amber-800 text-white font-bold py-2 px-4 rounded-full mr-3",onClick:j}," 共同管理員 "),e("button",{class:"flex items-center justify-center bg-green-700 hover:bg-green-800 text-white font-bold py-2 px-4 rounded-full",onClick:O}," 進入審核系統 ")])])],2)),x(z,{modelValue:n.value,"onUpdate:modelValue":s[0]||(s[0]=_=>n.value=_)},null,8,["modelValue"])],4))}};export{de as default};
