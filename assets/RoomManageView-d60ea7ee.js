import{y as j,u as O,r,f as H,e as u,s as N,o,c,a as e,i as h,n as M,h as x,t as _,l as p,k as y,m as $,p as D,q as L}from"./index-3b5c8014.js";import{u as B,_ as w}from"./LoadingCircleIcon-7e060727.js";import{_ as U}from"./ToastModal-9640e814.js";const Y={key:0,class:"flex flex-wrap w-full justify-center bg-white py-20"},z={key:1,class:"flex flex-wrap w-full justify-center bg-white py-20"},F={class:"flex justify-center my-16"},q={class:"max-w-md py-4 px-8 bg-white shadow-lg rounded-lg my-20"},K={class:"flex justify-center md:justify-end -mt-16"},P=["alt","src"],G={class:"text-gray-800 text-3xl font-semibold"},J={class:"text-sm font-normal"},Q={class:"mt-6 text-gray-600"},W={class:"mt-6 text-gray-600"},X=["innerHTML"],Z={class:"w-full mb-4 text-gray-600 flex rounded bg-white shadow-md"},ee=["value"],te={class:"flex justify-end mt-8"},se=["disabled"],ae={key:1},ce={__name:"RoomManageView",setup(oe){const{VITE_FREYA_INTE_HOST:k}={VITE_HOME_INTE_HOST:"https://web-tech.tw",VITE_SARA_INTE_HOST:"https://web-tech.tw/sara",VITE_SARA_TOKEN_NAME:"unified_token",VITE_FREYA_INTE_HOST:"https://web-tech.tw/freya",VITE_FREYA_RECV_HOST:"https://web-tech.tw/recv/freya",VITE_TURNSTILE_SITE_KEY:"0x4AAAAAAAz8kwCfcwYC8fgp",BASE_URL:"/freya/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},E=j(),T=O(),b=B(),{roomCode:n}=E.params,d=r(!1),g=r(!1),i=r(!1),m=r(!1),l=r(""),a=H({label:"",members:0,description:"",backgroundImage:""}),v=u(()=>`${k}/#/ti/g2/${n}`),I=u(()=>{const t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"},{description:s}=a;return s==null?void 0:s.replace(/[&<>"']/g,f=>t[f]).replaceAll(`
`,"<br />")}),A=u(()=>{const{backgroundImage:t}=a;return t?{backgroundImage:`url(${t})`}:{}}),C=u(()=>{const{backgroundImage:t}=a;return t?"backdrop-brightness-50":""}),V=async()=>{if(!navigator.clipboard){l.value="您的瀏覽器不支援複製功能";return}try{await navigator.clipboard.writeText(v.value),l.value="已複製邀請網址",m.value=!0,setTimeout(()=>{m.value=!1},3e3)}catch(t){l.value="無法複製邀請網址",console.error(t)}},R=async()=>{i.value=!0;const t=await b.patch(`rooms/${n}`).json();Object.assign(a,t),l.value="更新成功",i.value=!1},S=()=>{T.push(`/rooms/${n}/submissions`)};return N(async()=>{d.value=!0;try{const t=await b.get(`rooms/${n}`).json();Object.assign(a,t)}catch(t){g.value=!0,console.error(t)}d.value=!1}),(t,s)=>(o(),c("div",{style:$(A.value)},[g.value?(o(),c("div",Y,s[1]||(s[1]=[e("div",{class:"text-center text-red-500"}," 發生錯誤 ",-1)]))):d.value?(o(),c("div",z,[e("div",F,[h(w,{class:"h-8 w-8 animate-spin text-lime-600"})])])):(o(),c("div",{key:2,class:M(["flex flex-wrap w-full justify-center py-20",C.value])},[e("div",q,[e("div",K,[e("img",{alt:a.label,src:a.backgroundImage,class:"w-20 h-20 object-cover rounded-full border-2 border-white-500"},null,8,P)]),e("div",null,[e("h2",G,[x(_(a.label)+" ",1),e("span",J,_(p(n)),1)]),e("p",Q," 成員人數："+_(a.members),1),e("div",W,[s[2]||(s[2]=x(" 簡介： ")),e("p",{class:"my-2 mx-1 text-gray-800 text-sm",innerHTML:I.value},null,8,X)]),s[3]||(s[3]=e("p",{class:"mt-4 text-gray-600"}," 社群邀請網址： ",-1)),e("div",Z,[e("input",{value:v.value,class:"w-full border-none bg-transparent px-4 py-3 text-gray-900 outline-none focus:outline-none text-gray-500",type:"text",readonly:""},null,8,ee),e("button",{title:"複製",class:"m-2 rounded px-4 py-2 font-semibold",onClick:V},[m.value?(o(),y(p(D),{key:0,class:"h-6 w-6"})):(o(),y(p(L),{key:1,class:"h-6 w-6"}))])])]),e("div",te,[e("button",{class:"flex items-center justify-center bg-blue-700 hover:bg-blue-800 text-white font-bold py-2 px-4 rounded-full mr-3",onClick:R,disabled:i.value},[i.value?(o(),y(w,{key:0,class:"h-6 w-6 animate-spin"})):(o(),c("span",ae," 更新資訊 "))],8,se),e("button",{class:"flex items-center justify-center bg-green-700 hover:bg-green-800 text-white font-bold py-2 px-4 rounded-full",onClick:S}," 進入審核系統 ")])])],2)),h(U,{modelValue:l.value,"onUpdate:modelValue":s[0]||(s[0]=f=>l.value=f)},null,8,["modelValue"])],4))}};export{ce as default};
