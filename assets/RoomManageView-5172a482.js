import{z as N,u as $,h as n,j as M,i as c,x as D,o as l,c as i,a as e,f as h,n as L,l as w,t as d,e as b,p as x,g as Y,q as B,s as U}from"./index-0e150867.js";import{u as z,_ as T}from"./LoadingCircleIcon-8619bc91.js";import{_ as F}from"./ToastModal-12ff6d94.js";const K={key:0,class:"flex flex-wrap w-full justify-center bg-white py-20"},q={key:1,class:"flex flex-wrap w-full justify-center bg-white py-20"},P={class:"flex justify-center my-16"},G={class:"max-w-md py-4 px-8 bg-white shadow-lg rounded-lg my-20"},J={class:"flex justify-center md:justify-end -mt-16"},Q=["alt","src"],W={class:"text-gray-800 text-3xl font-semibold"},X={class:"text-sm font-normal"},Z={class:"mt-6 text-gray-600"},ee={class:"text-gray-600"},te={class:"mt-6 text-gray-600"},se=["innerHTML"],oe={class:"w-full mb-4 text-gray-600 flex rounded bg-white shadow-md"},ae=["value"],le={class:"flex justify-center mt-8"},re=["disabled"],ne={key:1},me={__name:"RoomManageView",setup(ce){const{VITE_FREYA_INTE_HOST:k}={VITE_HOME_INTE_HOST:"https://web-tech.tw",VITE_SARA_INTE_HOST:"https://web-tech.tw/sara",VITE_SARA_RECV_HOST:"https://web-tech.tw/recv/sara",VITE_SARA_TOKEN_TYPE:"SARA",VITE_SARA_TOKEN_NAME:"unified_token",VITE_FREYA_INTE_HOST:"https://web-tech.tw/freya",VITE_FREYA_RECV_HOST:"https://web-tech.tw/recv/freya",VITE_TURNSTILE_SITE_KEY:"0x4AAAAAAAz8kwCfcwYC8fgp",BASE_URL:"/freya/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},E=N(),m=$(),f=z(),{roomCode:r}=E.params,_=n(!1),v=n(!1),u=n(!1),p=n(!1),a=n(""),o=M({label:"",members:0,description:"",backgroundImage:"",administrators:[]}),A=c(()=>o.administrators.length),g=c(()=>`${k}/#/ti/g2/${r}`),I=c(()=>{const t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"},{description:s}=o;return s==null?void 0:s.replace(/[&<>"']/g,y=>t[y]).replaceAll(`
`,"<br />")}),C=c(()=>{const{backgroundImage:t}=o;return t?{backgroundImage:`url(${t})`}:{}}),R=c(()=>{const{backgroundImage:t}=o;return t?"backdrop-brightness-50":""}),S=async()=>{if(!navigator.clipboard){a.value="您的瀏覽器不支援複製功能";return}try{await navigator.clipboard.writeText(g.value),a.value="已複製邀請網址",p.value=!0,setTimeout(()=>{p.value=!1},3e3)}catch(t){a.value="無法複製邀請網址",console.error(t)}},V=async()=>{u.value=!0;const t=await f.patch(`rooms/${r}`).json();Object.assign(o,t),a.value="更新成功",u.value=!1},j=async()=>{if(confirm("確定要刪除社群？"))try{await f.delete(`rooms/${r}`),a.value="已刪除社群",setTimeout(()=>{m.push("/")},3e3)}catch(t){a.value="刪除社群失敗",console.error(t)}},O=()=>{m.push(`/rooms/${r}/administrators`)},H=()=>{m.push(`/rooms/${r}/submissions`)};return D(async()=>{_.value=!0;try{const t=await f.get(`rooms/${r}`).json();Object.assign(o,t)}catch(t){v.value=!0,console.error(t)}_.value=!1}),(t,s)=>(l(),i("div",{style:Y(C.value)},[v.value?(l(),i("div",K,s[1]||(s[1]=[e("div",{class:"text-center text-red-500"}," 發生錯誤 ",-1)]))):_.value?(l(),i("div",q,[e("div",P,[h(T,{class:"h-8 w-8 animate-spin text-lime-600"})])])):(l(),i("div",{key:2,class:L(["flex flex-wrap w-full justify-center py-20",R.value])},[e("div",G,[e("div",J,[e("img",{alt:o.label,src:o.backgroundImage,class:"w-20 h-20 object-cover rounded-full border-2 border-white-500"},null,8,Q)]),e("div",null,[e("h2",W,[w(d(o.label)+" ",1),e("span",X,d(b(r)),1)]),e("p",Z," 管理員人數："+d(A.value),1),e("p",ee," 成員人數："+d(o.members),1),e("div",te,[s[2]||(s[2]=w(" 簡介： ")),e("p",{class:"my-2 mx-1 text-gray-800 text-sm",innerHTML:I.value},null,8,se)]),s[3]||(s[3]=e("p",{class:"mt-4 text-gray-600"}," 社群邀請網址： ",-1)),e("div",oe,[e("input",{value:g.value,class:"w-full border-none bg-transparent px-4 py-3 text-gray-900 outline-none focus:outline-none text-gray-500",type:"text",readonly:""},null,8,ae),e("button",{title:"複製",class:"m-2 rounded px-4 py-2 font-semibold",onClick:S},[p.value?(l(),x(b(B),{key:0,class:"h-6 w-6"})):(l(),x(b(U),{key:1,class:"h-6 w-6"}))])])]),e("div",le,[e("button",{class:"flex items-center justify-center bg-blue-700 hover:bg-blue-800 text-white font-bold py-2 px-4 rounded-full mx-3 w-full",disabled:u.value,onClick:V},[u.value?(l(),x(T,{key:0,class:"h-6 w-6 animate-spin"})):(l(),i("span",ne," 更新資訊 "))],8,re),e("button",{class:"flex items-center justify-center bg-red-700 hover:bg-red-800 text-white font-bold py-2 px-4 rounded-full mx-3 w-full",onClick:j}," 刪除社群 ")]),e("div",{class:"flex justify-center mt-1"},[e("button",{class:"flex items-center justify-center bg-amber-700 hover:bg-amber-800 text-white font-bold py-2 px-4 rounded-full mx-3 w-full",onClick:O}," 管理人員 "),e("button",{class:"flex items-center justify-center bg-green-700 hover:bg-green-800 text-white font-bold py-2 px-4 rounded-full mx-3 w-full",onClick:H}," 審核系統 ")])])],2)),h(F,{modelValue:a.value,"onUpdate:modelValue":s[0]||(s[0]=y=>a.value=y)},null,8,["modelValue"])],4))}};export{me as default};
