import{z as H,u as D,h as i,j as L,i as c,x as M,o as a,c as n,a as e,f as w,n as Y,l as b,t as u,e as v,F as B,y as F,p as x,g as U,q as z,s as K}from"./index-72055197.js";import{u as P,_ as k}from"./LoadingCircleIcon-a03cdcee.js";import{_ as q}from"./ToastModal-1557e42a.js";const G={key:0,class:"flex flex-wrap w-full justify-center bg-white py-20"},J={key:1,class:"flex flex-wrap w-full justify-center bg-white py-20"},Q={class:"flex justify-center my-16"},W={class:"max-w-md py-4 px-8 bg-white shadow-lg rounded-lg my-20"},X={class:"flex justify-center md:justify-end -mt-16"},Z=["alt","src"],ee={class:"text-gray-800 text-3xl font-semibold"},te={class:"text-sm font-normal"},se={class:"mt-6 text-gray-600"},oe={class:"text-gray-600"},ae={class:"mt-6 text-gray-600"},le={class:"my-2 mx-1 text-gray-800 text-sm"},re={class:"w-full mb-4 text-gray-600 flex rounded bg-white shadow-md"},ne=["value"],ie={class:"flex justify-center mt-8"},ce=["disabled"],ue={key:1},pe={__name:"RoomManageView",setup(de){const{VITE_FREYA_INTE_HOST:E}={VITE_HOME_INTE_HOST:"https://web-tech.tw",VITE_SARA_INTE_HOST:"https://web-tech.tw/sara",VITE_SARA_RECV_HOST:"https://web-tech.tw/recv/sara",VITE_SARA_TOKEN_TYPE:"SARA",VITE_SARA_TOKEN_NAME:"unified_token",VITE_FREYA_INTE_HOST:"https://web-tech.tw/freya",VITE_FREYA_RECV_HOST:"https://web-tech.tw/recv/freya",VITE_TURNSTILE_SITE_KEY:"0x4AAAAAAAz8kwCfcwYC8fgp",BASE_URL:"/freya/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},T=H(),m=D(),f=P(),{roomCode:r}=T.params,_=i(!1),g=i(!1),d=i(!1),p=i(!1),l=i(""),s=L({label:"",members:0,description:"",backgroundImage:"",administrators:[]}),I=c(()=>s.administrators.length),h=c(()=>`${E}/#/ti/g2/${r}`),A=c(()=>s.description.split(`
`)),C=c(()=>{const{backgroundImage:t}=s;return t?{backgroundImage:`url(${t})`}:{}}),R=c(()=>{const{backgroundImage:t}=s;return t?"backdrop-brightness-50":""}),S=async()=>{if(!navigator.clipboard){l.value="您的瀏覽器不支援複製功能";return}try{await navigator.clipboard.writeText(h.value),l.value="已複製邀請網址",p.value=!0,setTimeout(()=>{p.value=!1},3e3)}catch(t){l.value="無法複製邀請網址",console.error(t)}},V=async()=>{d.value=!0;const t=await f.patch(`rooms/${r}`).json();Object.assign(s,t),l.value="更新成功",d.value=!1},j=async()=>{if(confirm("確定要刪除社群？"))try{await f.delete(`rooms/${r}`),l.value="已刪除社群",setTimeout(()=>{m.push("/")},3e3)}catch(t){l.value="刪除社群失敗",console.error(t)}},O=()=>{m.push(`/rooms/${r}/administrators`)},N=()=>{m.push(`/rooms/${r}/submissions`)};return M(async()=>{_.value=!0;try{const t=await f.get(`rooms/${r}`).json();Object.assign(s,t)}catch(t){g.value=!0,console.error(t)}_.value=!1}),(t,o)=>(a(),n("div",{style:U(C.value)},[g.value?(a(),n("div",G,o[1]||(o[1]=[e("div",{class:"text-center text-red-500"}," 發生錯誤 ",-1)]))):_.value?(a(),n("div",J,[e("div",Q,[w(k,{class:"h-8 w-8 animate-spin text-lime-600"})])])):(a(),n("div",{key:2,class:Y(["flex flex-wrap w-full justify-center py-20",R.value])},[e("div",W,[e("div",X,[e("img",{alt:s.label,src:s.backgroundImage,class:"w-20 h-20 object-cover rounded-full border-2 border-white-500"},null,8,Z)]),e("div",null,[e("h2",ee,[b(u(s.label)+" ",1),e("span",te,u(v(r)),1)]),e("p",se," 管理員人數："+u(I.value),1),e("p",oe," 成員人數："+u(s.members),1),e("div",ae,[o[3]||(o[3]=b(" 簡介： ")),e("p",le,[(a(!0),n(B,null,F(A.value,(y,$)=>(a(),n("span",{key:$},[b(u(y),1),o[2]||(o[2]=e("br",null,null,-1))]))),128))])]),o[4]||(o[4]=e("p",{class:"mt-4 text-gray-600"}," 社群邀請網址： ",-1)),e("div",re,[e("input",{value:h.value,class:"w-full border-none bg-transparent px-4 py-3 outline-none focus:outline-none text-gray-500",type:"text",readonly:""},null,8,ne),e("button",{title:"複製",class:"m-2 rounded px-4 py-2 font-semibold",onClick:S},[p.value?(a(),x(v(z),{key:0,class:"h-6 w-6"})):(a(),x(v(K),{key:1,class:"h-6 w-6"}))])])]),e("div",ie,[e("button",{class:"flex items-center justify-center bg-blue-700 hover:bg-blue-800 text-white font-bold py-2 px-4 rounded-full mx-3 w-full",disabled:d.value,onClick:V},[d.value?(a(),x(k,{key:0,class:"h-6 w-6 animate-spin"})):(a(),n("span",ue," 更新資訊 "))],8,ce),e("button",{class:"flex items-center justify-center bg-red-700 hover:bg-red-800 text-white font-bold py-2 px-4 rounded-full mx-3 w-full",onClick:j}," 刪除社群 ")]),e("div",{class:"flex justify-center mt-1"},[e("button",{class:"flex items-center justify-center bg-amber-700 hover:bg-amber-800 text-white font-bold py-2 px-4 rounded-full mx-3 w-full",onClick:O}," 管理人員 "),e("button",{class:"flex items-center justify-center bg-green-700 hover:bg-green-800 text-white font-bold py-2 px-4 rounded-full mx-3 w-full",onClick:N}," 審核系統 ")])])],2)),w(q,{modelValue:l.value,"onUpdate:modelValue":o[0]||(o[0]=y=>l.value=y)},null,8,["modelValue"])],4))}};export{pe as default};
