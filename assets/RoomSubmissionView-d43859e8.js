import{x as A,r as d,f as j,e as C,y as S,q as I,o,c as l,a as e,n as N,i as c,h as p,t as u,l as m,j as L,v as M,k as b,z as V,A as z,B as O,C as R,D as T}from"./index-e8cc82c4.js";import{u as U,_ as h}from"./LoadingCircleIcon-83a13acb.js";import{_ as q}from"./ToastModal-d7eba799.js";const E={key:0,class:"absolute top-36 flex flex-col w-full"},Q={key:1,class:"absolute top-36 flex flex-col w-full"},F={class:"flex justify-center my-16"},G={key:2,class:"absolute top-36 flex flex-col w-full justify-start"},H={class:"w-full flex justify-center"},J={class:"max-w-md py-4 px-8 bg-white shadow-lg rounded-lg mt-20 mb-8"},K={class:"flex justify-center md:justify-end -mt-16"},P=["alt","src"],W={class:"text-gray-800 text-3xl font-semibold"},X={class:"text-sm font-normal"},Y={class:"w-full mb-4 text-gray-600 flex rounded bg-white shadow-md"},Z={key:0,class:"w-full flex justify-center"},ee={key:0,class:"max-w-md py-4 px-8 bg-white shadow-lg rounded-lg mb-20"},se={key:1,class:"max-w-md py-4 px-8 bg-white shadow-lg rounded-lg mb-20"},te={class:"flex justify-center my-2"},oe={class:"my-4 text-gray-600"},ae={class:"font-normal"},le={key:0,class:"my-4 text-gray-600"},ne={key:2,class:"max-w-md py-4 px-8 bg-white shadow-lg rounded-lg mb-20"},re={class:"flex justify-center my-2"},de={class:"my-4 text-gray-600"},ie={class:"font-normal"},ye={__name:"RoomSubmissionView",setup(ce){const $=A(),w=U(),{roomCode:f}=$.params,x=d(!1),_=d(!1),y=d(!1),n=d(!1),v=d(""),r=d(""),i=j({label:"",description:"",backgroundImage:""}),a=j({code:"",roomCode:"",createdAt:"",updatedAt:""}),k=C(()=>n.value&&a.roomCode===f),B=C(()=>{const{backgroundImage:t}=i;return{backgroundImage:`url(${t})`,filter:"brightness(0.3)",height:"100vh"}});S(r,t=>{t!==a.code&&(n.value=!1,a.code="",a.roomCode="")});const D=async()=>{if(!r.value){v.value="請輸入驗證碼";return}if(n.value){r.value="";return}a.code=r.value,y.value=!0,n.value=!0;try{const t=await w.get(`rooms/${f}/submissions/${a.code}`).json();Object.assign(a,t)}catch(t){console.error(t)}y.value=!1};return I(async()=>{x.value=!0;try{const t=await w.get(`rooms/${f}`).json();Object.assign(i,t)}catch(t){_.value=!0,console.error(t)}x.value=!1}),(t,s)=>(o(),l("div",null,[e("div",{style:N(B.value)},null,4),_.value?(o(),l("div",E,s[2]||(s[2]=[e("div",{class:"text-center text-red-500"}," 發生錯誤 ",-1)]))):x.value?(o(),l("div",Q,[e("div",F,[c(h,{class:"h-8 w-8 animate-spin text-lime-600"})])])):(o(),l("div",G,[e("div",H,[e("div",J,[e("div",K,[e("img",{alt:i.label,src:i.backgroundImage,class:"w-20 h-20 object-cover rounded-full border-2 border-white-500"},null,8,P)]),e("h2",W,[p(u(i.label)+" ",1),e("span",X,u(m(f)),1)]),s[3]||(s[3]=e("p",{class:"mt-6 text-gray-600"}," 社群加入申請管理系統 ",-1)),s[4]||(s[4]=e("p",{class:"mt-6 text-gray-600"}," 請輸入對方提供的驗證碼： ",-1)),e("div",Y,[L(e("input",{"onUpdate:modelValue":s[0]||(s[0]=g=>r.value=g),placeholder:"pmShBo2Bg",class:"w-full border-none bg-transparent px-4 py-3 text-gray-900 outline-none focus:outline-none text-gray-500",type:"text"},null,512),[[M,r.value]]),e("button",{class:"m-2 rounded px-4 py-2 font-semibold",onClick:D},[y.value?(o(),b(h,{key:0,class:"h-6 w-6 animate-spin"})):n.value?(o(),b(m(z),{key:1,class:"h-6 w-6"})):(o(),b(m(O),{key:2,class:"h-6 w-6"}))])])])]),n.value?(o(),l("div",Z,[y.value?(o(),l("div",ee,[c(h,{class:"w-14 h-14 animate-spin"})])):k.value?(o(),l("div",se,[e("div",te,[c(m(R),{class:"w-14 h-14 rounded-full bg-white border-2 border-white-500"})]),s[6]||(s[6]=e("h3",{class:"text-gray-800 text-xl font-semibold"}," 驗證碼有效 ",-1)),e("p",oe,[s[5]||(s[5]=p(" 驗證碼： ")),e("span",ae,u(a.code),1)]),k.value?(o(),l("p",le," 申請時間："+u(new Date(a.createdAt).toLocaleString()),1)):V("",!0)])):(o(),l("div",ne,[e("div",re,[c(m(T),{class:"w-14 h-14 rounded-full bg-white border-2 border-white-500"})]),s[8]||(s[8]=e("h3",{class:"text-gray-800 text-xl font-semibold"}," 驗證碼無效 ",-1)),e("p",de,[s[7]||(s[7]=p(" 驗證碼： ")),e("span",ie,u(a.code),1)])]))])):V("",!0)])),c(q,{modelValue:v.value,"onUpdate:modelValue":s[1]||(s[1]=g=>v.value=g)},null,8,["modelValue"])]))}};export{ye as default};
