import{z as S,h as i,j as C,i as b,A as I,x as N,o,c as l,a as e,f as u,n as z,l as v,t as m,e as f,m as L,v as M,p as w,B as V,g as E,C as O,D as R,E as T,G as U}from"./index-8904b43b.js";import{u as G,_ as h}from"./LoadingCircleIcon-69525aa4.js";import{_ as Q}from"./ToastModal-8d28eee4.js";const q={key:0,class:"flex flex-wrap w-full justify-center bg-white py-20"},F={key:1,class:"flex flex-wrap w-full justify-center bg-white py-20"},H={class:"flex justify-center my-16"},J={class:"w-full flex justify-center"},K={class:"max-w-md py-4 px-8 bg-white shadow-lg rounded-lg mt-20 mb-8"},P={class:"flex justify-center md:justify-end -mt-16"},W=["alt","src"],X={class:"text-gray-800 text-3xl font-semibold"},Y={class:"text-sm font-normal"},Z={class:"w-full mb-4 text-gray-600 flex rounded bg-white shadow-md"},ee=["disabled"],se={key:0,class:"w-full flex justify-center"},te={key:0,class:"max-w-md py-4 px-8 bg-white shadow-lg rounded-lg mb-20"},oe={key:1,class:"max-w-md py-4 px-8 bg-white shadow-lg rounded-lg mb-20"},ae={class:"flex justify-center my-2"},le={class:"my-4 text-gray-600"},ne={class:"font-normal"},re={key:0,class:"my-4 text-gray-600"},de={key:2,class:"max-w-md py-4 px-8 bg-white shadow-lg rounded-lg mb-20"},ie={class:"flex justify-center my-2"},ce={class:"my-4 text-gray-600"},ue={class:"font-normal"},ge={__name:"RoomSubmissionView",setup(me){const $=S(),_=G(),{roomCode:y}=$.params,p=i(!1),k=i(!1),c=i(!1),n=i(!1),g=i(""),r=i(""),d=C({label:"",description:"",backgroundImage:""}),a=C({code:"",roomCode:"",createdAt:"",updatedAt:""}),j=b(()=>n.value&&a.roomCode===y),B=b(()=>{const{backgroundImage:t}=d;return t?{backgroundImage:`url(${t})`}:{}}),D=b(()=>{const{backgroundImage:t}=d;return t?"backdrop-brightness-50":""});I(r,t=>{t!==a.code&&(n.value=!1,a.code="",a.roomCode="")});const A=async()=>{if(!r.value){g.value="請輸入驗證碼";return}if(n.value){r.value="";return}a.code=r.value,c.value=!0,n.value=!0;try{const t=await _.get(`rooms/${y}/submissions/${a.code}`).json();Object.assign(a,t)}catch(t){console.error(t)}c.value=!1};return N(async()=>{p.value=!0;try{const t=await _.get(`rooms/${y}`).json();Object.assign(d,t)}catch(t){k.value=!0,console.error(t)}p.value=!1}),(t,s)=>(o(),l("div",{style:E(B.value)},[k.value?(o(),l("div",q,s[2]||(s[2]=[e("div",{class:"text-center text-red-500"}," 發生錯誤 ",-1)]))):p.value?(o(),l("div",F,[e("div",H,[u(h,{class:"h-8 w-8 animate-spin text-lime-600"})])])):(o(),l("div",{key:2,class:z(["flex flex-wrap w-full justify-center py-20",D.value])},[e("div",J,[e("div",K,[e("div",P,[e("img",{alt:d.label,src:d.backgroundImage,class:"w-20 h-20 object-cover rounded-full border-2 border-white-500"},null,8,W)]),e("h2",X,[v(m(d.label)+" ",1),e("span",Y,m(f(y)),1)]),s[3]||(s[3]=e("p",{class:"mt-6 text-gray-600"}," 社群加入申請管理系統 ",-1)),s[4]||(s[4]=e("p",{class:"mt-6 text-gray-600"}," 請輸入對方提供的驗證碼： ",-1)),e("div",Z,[L(e("input",{"onUpdate:modelValue":s[0]||(s[0]=x=>r.value=x),placeholder:"pmShBo2Bg",class:"w-full border-none bg-transparent px-4 py-3 text-gray-900 outline-none focus:outline-none text-gray-500",type:"text"},null,512),[[M,r.value]]),e("button",{class:"m-2 rounded px-4 py-2 font-semibold",disabled:c.value,onClick:A},[c.value?(o(),w(h,{key:0,class:"h-6 w-6 animate-spin"})):n.value?(o(),w(f(O),{key:1,class:"h-6 w-6"})):(o(),w(f(R),{key:2,class:"h-6 w-6"}))],8,ee)])])]),n.value?(o(),l("div",se,[c.value?(o(),l("div",te,[u(h,{class:"w-14 h-14 animate-spin"})])):j.value?(o(),l("div",oe,[e("div",ae,[u(f(T),{class:"w-14 h-14 rounded-full bg-white border-2 border-white-500"})]),s[6]||(s[6]=e("h3",{class:"text-gray-800 text-xl font-semibold"}," 驗證碼有效 ",-1)),e("p",le,[s[5]||(s[5]=v(" 驗證碼： ")),e("span",ne,m(a.code),1)]),j.value?(o(),l("p",re," 申請時間："+m(new Date(a.createdAt).toLocaleString()),1)):V("",!0)])):(o(),l("div",de,[e("div",ie,[u(f(U),{class:"w-14 h-14 rounded-full bg-white border-2 border-white-500"})]),s[8]||(s[8]=e("h3",{class:"text-gray-800 text-xl font-semibold"}," 驗證碼無效 ",-1)),e("p",ce,[s[7]||(s[7]=v(" 驗證碼： ")),e("span",ue,m(a.code),1)])]))])):V("",!0)],2)),u(Q,{modelValue:g.value,"onUpdate:modelValue":s[1]||(s[1]=x=>g.value=x)},null,8,["modelValue"])],4))}};export{ge as default};
